<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta content="text/html; charset=<?php echo $cfg_soft_lang; ?>" http-equiv="Content-Type">
    <title>木马自检程序</title>
    <link href="css/base.css" rel="stylesheet" type="text/css"/>
    <link href="css/indexbody.css" rel="stylesheet" type="text/css"/>
    <style type="text/css">
        td {
            padding-left: 8px;
        }
    </style>
    <script language='javascript' src='js/main.js'></script>
    <script language="javascript" src="../include/js/dedeajax2.js"></script>
    <script language='javascript'>

        function LoadCtTest() {
            var filetype = $Obj('filetype').value;
            var info = $Obj('info').value;
            $Obj('loaddiv').style.display = 'block';
            var myajax = new DedeAjax($DE('messagetd'));
            myajax.SendGet2('sys_safetest.php?action=test&filetype=' + filetype + "&info=" + info);
            $Obj('loaddiv').style.display = 'none';
        }

        function LoadCtClear() {
            $Obj('loaddiv').style.display = 'block';
            var myajax = new DedeAjax($DE('messagetd'));
            myajax.SendGet2('sys_safetest.php?action=clear');
            $Obj('loaddiv').style.display = 'none';
        }

    </script>
</head>
<body background='images/allbg.gif' leftmargin="8" topmargin="8">

<div id='loaddiv' style='display:none'>
    <p align='center' style='padding-top:200px'><img src='images/loadinglit.gif'/> 请稍后，正在操作中...</p>
</div>

<div class="bodytitle">
    <div class="bodytitleleft"></div>
    <div class="bodytitletxt" style="padding-left:10px;">用户安全中心</div>
</div>
<table align="center" border="0" cellpadding="1" cellspacing="1" class="tbtitle" style="background:#CFCFCF;"
       width="98%">
    <tr>
        <td background="images/tbg.gif" bgcolor="#EDF9D5" colspan="2" height="24" style="padding-left:10px;"
            width="100%">
            <b>木马自检程序</b>
        </td>
    </tr>
    <tr>
        <td bgcolor="#FFFFFF" colspan="2" height="73">
            <strong>安全建议：</strong>
            <br/>
            1、有条件的用户把中 data、templets、uploads、html、special、images、install目录设置为不允许执行脚本，其它目录禁止写入，系统将更安全；<br/>
            2、本检测程以开发模式为标准，如果您的网站目录包含其它系统，此检测程序可能会产生错误判断；<br/>
            3、检测程序会跳过对模板缓存目录的检测，为了安全起见，检测完成后建议清空模板缓存。
        </td>
    </tr>
    <tr>
        <td bgcolor="#FFFFFF" colspan="2" height="50"><p>文件类型：
            <input id="filetype" name="filetype" style="width:420px" type="text" value="php|inc"/>
            &nbsp;要检查的文件类型</p>
            <p>代码特征：
                <input id="info" name="info" style="width:420px" type="text" value="eval|cmd|system|exec|_GET|_POST"/>
                &nbsp;特征代码</p></td>
    </tr>
    <tr>
        <td bgcolor="#FFFFFF" colspan="2" height="50">
            <input class="coolbg np" name="bt1" onclick="LoadCtTest();" type="button" value="开始检测"/>
            &nbsp;
            <input class="coolbg np" name="bt2" onclick="LoadCtClear();" type="button" value="清空模板缓存"/>
        </td>
    </tr>
    <tr>
        <td bgcolor="#F9FCEF" colspan="2" height="30">检测结果：(结果仅供参考，请务必查看源码后才删除非法文件)</td>
    </tr>
    <tr>
        <td bgcolor="#FFFFFF" colspan="2" height="300" id="messagetd" valign="top">
        </td>
    </tr>
</table>
</body>
</html>